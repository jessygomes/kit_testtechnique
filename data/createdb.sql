BEGIN;

DROP TABLE IF EXISTS "user", "pot", "plante", "color", "pot_color" CASCADE;

CREATE TABLE "user" (
  "id" INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  "nom" VARCHAR(255) NOT NULL,
  "prenom" VARCHAR(255) NOT NULL,
  "email" VARCHAR(255) NOT NULL UNIQUE,
  "password" VARCHAR(255) NOT NULL,
  "role" VARCHAR(255) DEFAULT 'user',
  "is_logged" BOOLEAN DEFAULT FALSE,
  "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE "pot" (
  "id" INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  "name_pot" VARCHAR(255) NOT NULL,
  "image_url" VARCHAR(255),
  "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE TABLE "color" (
  "id" INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  "name_color" VARCHAR(255) NOT NULL
);

CREATE TABLE "pot_color" (
  "pot_id" INTEGER NOT NULL,
  "color_id" INTEGER NOT NULL,
  PRIMARY KEY ("pot_id", "color_id"),
  FOREIGN KEY ("pot_id") REFERENCES "pot"("id") ON DELETE CASCADE,
  FOREIGN KEY ("color_id") REFERENCES "color"("id") ON DELETE CASCADE
);

CREATE TABLE "plante" (
  "id" INTEGER GENERATED ALWAYS AS IDENTITY PRIMARY KEY,
  "name_plante" VARCHAR(255) NOT NULL,
  "image_url" VARCHAR(255),
  "created_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP,
  "updated_at" TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

COMMIT;